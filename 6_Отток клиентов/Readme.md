# Отток клиентов

## Цель проекта
Из «Бета-Банка» стали уходить клиенты. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Имеются исторические данные о поведении клиентов и расторжении договоров с банком.

Необходимо построить модель с предельно большим значением F1- меры, нужно довести метрику до 0.59, проверить F1- меру на тестовой выборке .

Дополнительно нужно измерять метрику AUC-ROC, сравнить её значение с F1-мерой.

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

## Основные этапы работы
1. Подготовка данных
2. Предобработка датасета
3. Исследовательский анализ, обучение и валидация ML-моделей
    - решающее дерево
    - случайный лес
    - логистическая регрессия
4. Тестирование ML-моделей
5. Вывод по проекту

## Выводы по проекту
- В текущем проекте были отработаны навыки загрузки необходимых инструментов обработки данных (библиотеки, метрики, модели машинного обучения), предобработки содержимого датасета (коррекция названий столбцов, заполнение пропусков, использование порядкового кодирования, отделение целевого признака от датасета, масштабирование признаков, разделение данных на тренировочную, валидационную и тестовую выборки).

- Исследован датафрейм с точки зрения баланса классов данных. Указано, что в исходном датасете количество положительных объектов в 4 раза меньше, чем отрицательных. Произведено исследование работы моделей до балансировки классов. Показатели моделей: 
        решающее дерево - f1 = 0.577039, auc_roc = 0.805940; 
        случайный лес -  f1 = 0.585949,  auc_roc = 0.844480; 
        логистическая регрессия - f1 = 0.336700,  auc_roc = 0.7589130. 

- Произведена балансировка данных путем наращивания количества положительных классов. Осуществлено обучение моделей на новых данных и их тестирование на валидационной выборке. Показатели полученных моделей:
        решающее дерево - f1 = 0.601047, auc_roc = 0.804364; 
        случайный лес - f1 = 0.622532, auc_roc = 0.838193; 
        логистическая регрессия - f1: 0.492281, auc_roc = 0.764201.

- Модели обучены на объединенных тренировочной выборке, затем проведена проверка на тестовых данных. Показатели моделей:
        решающее дерево - f1 = 0.586667, auc-roc = 0.839050; 
        случайный лес - f1 = 0.606715, auc_roc = 0.846710; 
        логистическая регрессия -  0.483816, auc_roc = 0.740049.

Таким образом, требуемое значение f1-метрики было достигнуто моделью случайного леса. Данная модель является рекомендуемой для использования при решении поставленной задачи предсказания оттока клиентов банка.

## Готовность проекта 
**Выполнен**

## Используемые инструменты
Pandas, Numpy, sklearn, DecisionTreeClassifier, RandomForestClassifier, LogisticRegression, train_test_split, f1_score, AUC_ROC_score, Matplotlib
